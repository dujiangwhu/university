<!DOCTYPE html>
<html>
<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="google" content="notranslate">

<title>交叉报表</title>

    <link rel="stylesheet" href="/extjslib60/pivot-Grid/pivot-Alone/css/KitchenSink-all_1.css" />
    <link rel="stylesheet" href="/extjslib60/pivot-Grid/pivot-Alone/css/KitchenSink-all_2.css" />

    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/ext-all-debug.js"></script>

    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/pivot.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/Configurator.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/DrillDownNoId.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/Exporter.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/RangeEditor.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/Column_CHS.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/Container.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/DragZone.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/DropZone.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/FilterLabelWindow_CHS.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/FilterTopWindow_CHS.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/FilterValueWindow_CHS.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/Panel_CHS.js"></script>

    <script type="text/javascript">
        var Ext = Ext || {};
        Ext.beforeLoad = function(tags){
            var profile = location.href.match(/profile=([\w-]+)/),
                    locale = location.href.match(/locale=([\w-]+)/);

            profile  = (profile && profile[1]) || (tags.phone ? 'modern-triton' : 'triton');
            locale = (locale && locale[1]) || 'en';

            Ext.manifest = profile + "-" + locale;
            tags.test = /testMode=true/.test(location.search);
            Ext.microloaderTags = tags;
        };
    </script>

    <script type="text/javascript">
    Ext.onReady(function(){
        var store1 = new Ext.data.Store({
            data : [{"id":"1","问卷编号":"100005","最近一年内，您购买并使用过哪些品牌的手机呢？":"苹果","样本数量":"1"},{"id":"2","问卷编号":"100006","最近一年内，您购买并使用过哪些品牌的手机呢？":"联想","样本数量":"1"},{"id":"3","问卷编号":"100007","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"4","问卷编号":"100008","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"5","问卷编号":"100009","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"6","问卷编号":"100010","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"7","问卷编号":"100011","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"8","问卷编号":"100012","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"9","问卷编号":"100013","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"10","问卷编号":"100014","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"11","问卷编号":"100015","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"12","问卷编号":"100016","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"13","问卷编号":"100017","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"14","问卷编号":"100018","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"15","问卷编号":"100019","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"16","问卷编号":"100020","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"17","问卷编号":"100021","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"18","问卷编号":"100022","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"19","问卷编号":"100023","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"20","问卷编号":"100024","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"21","问卷编号":"100025","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"22","问卷编号":"100026","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"23","问卷编号":"100027","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"24","问卷编号":"100028","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"25","问卷编号":"100029","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"26","问卷编号":"100030","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"27","问卷编号":"100031","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"28","问卷编号":"100032","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"29","问卷编号":"100033","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"30","问卷编号":"100034","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"31","问卷编号":"100035","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"},{"id":"32","问卷编号":"100036","最近一年内，您购买并使用过哪些品牌的手机呢？":"","样本数量":"1"}],
			fields : ['问卷编号','最近一年内，您购买并使用过哪些品牌的手机呢？','样本数量'],
        });
		var strTitle="交叉报表测试";
		var strFileName="交叉报表测试.xls";
        //Grid Panel
        var grid = new Ext.pivot.Grid({
            title: strTitle,
			header: {
	            itemPosition: 1, // after title before collapse tool
	            items: [{
	                ui: 'default-toolbar',
	                xtype: 'button',
	                text: '导出Excel',
					handler:function(btn){
						var ptgrid = btn.findParentByType('pivotgrid');
						var recs = ptgrid.store.getRange();
						if(recs.length<=0){
							Ext.MessageBox.alert('提示', '请先生成报表，再执行导出操作！');
						}else{
							ptgrid.saveDocumentAs({
	                            type: 'excel',
	                            title:strTitle,
	                            fileName: strFileName
                       		});
						};
					}
	            }]
        	},
            renderTo: 'div1',
            columnLines: true,
            stripeRows : true,
            loadMask : {msg : 'Loading...'},
            autoWidth: true,
            collapsible: true,
            multiSelect: true,
            height: 600,
            selModel: {
                type: 'spreadsheet'
            },

            plugins: [
                {
                    ptype:'pivotconfigurator',
                    pluginId:'configurator',
                    fields:[{dataIndex:'问卷编号',header:'问卷编号'},{dataIndex:'最近一年内，您购买并使用过哪些品牌的手机呢？',header:'最近一年内，您购买并使用过哪些品牌的手机呢？'},{dataIndex:'样本数量',header:'样本数量'}]
                },
                {
                    ptype: 'pivotdrilldown',
                    pluginId: 'pivotdrilldown',
                    textWindow: '详细信息',
                    //columns: [],
                    //lockableScope:  'top',
                    width:800,
                    height:480
                },
				{
                    ptype: 'pivotexporter'
                }
            ],

            viewConfig: { },
            store:  store1,
            aggregate: [{dataIndex: '样本数量',header:'样本数量',aggregator: 'sum'}],

            colSubTotalsPosition:"none",
            colGrandTotalsPosition:"none",
            rowSubTotalsPosition:"none",
            rowGrandTotalsPosition:"none",
        });
    });
    </script>
    </head>

    <body>
        <div id="div1">

        </div>
    </body>
</html>
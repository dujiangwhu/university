<!DOCTYPE html>
<html>
<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="google" content="notranslate">

<title>交叉报表</title>

    <link rel="stylesheet" href="/extjslib60/pivot-Grid/pivot-Alone/css/KitchenSink-all_1.css" />
    <link rel="stylesheet" href="/extjslib60/pivot-Grid/pivot-Alone/css/KitchenSink-all_2.css" />

    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/ext-all-debug.js"></script>

    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/pivot.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/Configurator.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/DrillDownNoId.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/Exporter.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/RangeEditor.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/Column.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/Container.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/DragZone.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/DropZone.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/FilterLabelWindow.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/FilterTopWindow.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/FilterValueWindow.js"></script>
    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/Panel.js"></script>

    <script type="text/javascript">
        var Ext = Ext || {};
        Ext.beforeLoad = function(tags){
            var profile = location.href.match(/profile=([\w-]+)/),
                    locale = location.href.match(/locale=([\w-]+)/);

            profile  = (profile && profile[1]) || (tags.phone ? 'modern-triton' : 'triton');
            locale = (locale && locale[1]) || 'en';

            Ext.manifest = profile + "-" + locale;
            tags.test = /testMode=true/.test(location.search);
            Ext.microloaderTags = tags;
        };
    </script>

    <script type="text/javascript">
    Ext.onReady(function(){
        var store1 = new Ext.data.Store({
            data : [{"id":"1","问卷编号":"100037","您的性别是":"男","您的年龄是":"小于18岁","样本数量":"1"},{"id":"2","问卷编号":"100038","您的性别是":"男","您的年龄是":"小于18岁","样本数量":"1"},{"id":"3","问卷编号":"100039","您的性别是":"男","您的年龄是":"小于18岁","样本数量":"1"},{"id":"4","问卷编号":"100040","您的性别是":"男","您的年龄是":"小于18岁","样本数量":"1"},{"id":"5","问卷编号":"100041","您的性别是":"男","您的年龄是":"18—24岁","样本数量":"1"},{"id":"6","问卷编号":"100042","您的性别是":"男","您的年龄是":"18—24岁","样本数量":"1"},{"id":"7","问卷编号":"100043","您的性别是":"男","您的年龄是":"18—24岁","样本数量":"1"},{"id":"8","问卷编号":"100044","您的性别是":"男","您的年龄是":"18—24岁","样本数量":"1"},{"id":"9","问卷编号":"100045","您的性别是":"男","您的年龄是":"18—24岁","样本数量":"1"},{"id":"10","问卷编号":"100046","您的性别是":"男","您的年龄是":"18—24岁","样本数量":"1"},{"id":"11","问卷编号":"100047","您的性别是":"男","您的年龄是":"18—24岁","样本数量":"1"},{"id":"12","问卷编号":"100048","您的性别是":"男","您的年龄是":"18—24岁","样本数量":"1"},{"id":"13","问卷编号":"100049","您的性别是":"男","您的年龄是":"18—24岁","样本数量":"1"},{"id":"14","问卷编号":"100050","您的性别是":"男","您的年龄是":"18—24岁","样本数量":"1"},{"id":"15","问卷编号":"100051","您的性别是":"女","您的年龄是":"18—24岁","样本数量":"1"},{"id":"16","问卷编号":"100052","您的性别是":"女","您的年龄是":"18—24岁","样本数量":"1"},{"id":"17","问卷编号":"100053","您的性别是":"女","您的年龄是":"18—24岁","样本数量":"1"},{"id":"18","问卷编号":"100054","您的性别是":"女","您的年龄是":"25岁—30岁","样本数量":"1"},{"id":"19","问卷编号":"100055","您的性别是":"女","您的年龄是":"25岁—30岁","样本数量":"1"},{"id":"20","问卷编号":"100056","您的性别是":"女","您的年龄是":"25岁—30岁","样本数量":"1"},{"id":"21","问卷编号":"100057","您的性别是":"女","您的年龄是":"25岁—30岁","样本数量":"1"},{"id":"22","问卷编号":"100058","您的性别是":"女","您的年龄是":"25岁—30岁","样本数量":"1"},{"id":"23","问卷编号":"100059","您的性别是":"女","您的年龄是":"25岁—30岁","样本数量":"1"},{"id":"24","问卷编号":"100060","您的性别是":"女","您的年龄是":"25岁—30岁","样本数量":"1"},{"id":"25","问卷编号":"100061","您的性别是":"女","您的年龄是":"25岁—30岁","样本数量":"1"},{"id":"26","问卷编号":"100062","您的性别是":"女","您的年龄是":"25岁—30岁","样本数量":"1"},{"id":"27","问卷编号":"100063","您的性别是":"女","您的年龄是":"30岁以上","样本数量":"1"},{"id":"28","问卷编号":"100064","您的性别是":"女","您的年龄是":"30岁以上","样本数量":"1"},{"id":"29","问卷编号":"100065","您的性别是":"女","您的年龄是":"30岁以上","样本数量":"1"},{"id":"30","问卷编号":"100066","您的性别是":"女","您的年龄是":"30岁以上","样本数量":"1"}],
			fields : ['问卷编号','您的性别是','您的年龄是','样本数量'],
        });
        //Grid Panel
        var grid = new Ext.pivot.Grid({
            title: '交叉报表',
            renderTo: 'div1',
            columnLines: true,
            stripeRows : true,
            loadMask : {msg : 'Loading...'},
            autoWidth: true,
            collapsible: true,
            multiSelect: true,
            height: 600,
            selModel: {
                type: 'spreadsheet'
            },

            plugins: [
                {
                    ptype:'pivotconfigurator',
                    pluginId:'configurator',
                    fields:[{dataIndex:'问卷编号',header:'问卷编号'},{dataIndex:'您的性别是',header:'您的性别是'},{dataIndex:'您的年龄是',header:'您的年龄是'},{dataIndex:'样本数量',header:'样本数量'}]
                },
                {
                    ptype: 'pivotdrilldown',
                    pluginId: 'pivotdrilldown',
                    textWindow: '详细信息',
                    //columns: [],
                    //lockableScope:  'top',
                    width:800,
                    height:480
                }
            ],

            viewConfig: { },
            store:  store1,
            aggregate: [{dataIndex: '样本数量',header:'样本数量',aggregator: 'sum'}],

            colSubTotalsPosition:"none",
            colGrandTotalsPosition:"none",
            rowSubTotalsPosition:"none",
            rowGrandTotalsPosition:"none",
        });
    });
    </script>
    </head>

    <body>
        <div id="div1">

        </div>
    </body>
</html>
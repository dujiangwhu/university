<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="google" content="notranslate"><title>交叉报表</title>    <link rel="stylesheet" href="/extjslib60/pivot-Grid/pivot-Alone/css/KitchenSink-all_1.css" />    <link rel="stylesheet" href="/extjslib60/pivot-Grid/pivot-Alone/css/KitchenSink-all_2.css" />    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/ext-all-debug.js"></script>    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/pivot.js"></script>    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/Configurator.js"></script>    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/DrillDownNoId.js"></script>    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/Exporter.js"></script>    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/RangeEditor.js"></script>    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/Column_CHS.js"></script>    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/Container.js"></script>    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/DragZone.js"></script>    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/DropZone.js"></script>    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/FilterLabelWindow_CHS.js"></script>    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/FilterTopWindow_CHS.js"></script>    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/FilterValueWindow_CHS.js"></script>    <script type="text/javascript" src="/extjslib60/pivot-Grid/pivot-Alone/pivot/plugin/configurator/Panel_CHS.js"></script>    <script type="text/javascript">        var Ext = Ext || {};        Ext.beforeLoad = function(tags){            var profile = location.href.match(/profile=([\w-]+)/),                    locale = location.href.match(/locale=([\w-]+)/);            profile  = (profile && profile[1]) || (tags.phone ? 'modern-triton' : 'triton');            locale = (locale && locale[1]) || 'en';            Ext.manifest = profile + "-" + locale;            tags.test = /testMode=true/.test(location.search);            Ext.microloaderTags = tags;        };    </script>    <script type="text/javascript">    Ext.onReady(function(){        var store1 = new Ext.data.Store({            data : [],			fields : ['问卷编号','多选题','academic advisers','样本数量'],        });		var strTitle="演示模板-001";		var strFileName="演示模板-001.xls";        //Grid Panel        var grid = new Ext.pivot.Grid({            title: strTitle,			header: {	            itemPosition: 1, // after title before collapse tool	            items: [{	                ui: 'default-toolbar',	                xtype: 'button',	                text: '导出Excel',					handler:function(btn){						var ptgrid = btn.findParentByType('pivotgrid');						var recs = ptgrid.store.getRange();						if(recs.length<=0){							Ext.MessageBox.alert('提示', '请先生成报表，再执行导出操作！');						}else{							ptgrid.saveDocumentAs({	                            type: 'excel',	                            title:strTitle,	                            fileName: strFileName                       		});						};					}	            }]        	},            renderTo: 'div1',            columnLines: true,            stripeRows : true,            loadMask : {msg : 'Loading...'},            autoWidth: true,            collapsible: true,            multiSelect: true,            height: 600,            selModel: {                type: 'spreadsheet'            },            plugins: [                {                    ptype:'pivotconfigurator',                    pluginId:'configurator',                    fields:[{dataIndex:'问卷编号',header:'问卷编号'},{dataIndex:"多选题",header:"多选题"},{dataIndex:"academic advisers",header:"academic advisers"},{dataIndex:'样本数量',header:'样本数量'}]                },                {                    ptype: 'pivotdrilldown',                    pluginId: 'pivotdrilldown',                    textWindow: '详细信息',                    //columns: [],                    //lockableScope:  'top',                    width:800,                    height:480                },				{                    ptype: 'pivotexporter'                }            ],            viewConfig: { },            store:  store1,            aggregate: [{dataIndex: '样本数量',header:'样本数量',aggregator: 'sum'}],            colSubTotalsPosition:"none",            colGrandTotalsPosition:"none",            rowSubTotalsPosition:"none",            rowGrandTotalsPosition:"none",        });    });    </script>    </head>    <body>        <div id="div1">        </div>    </body></html>